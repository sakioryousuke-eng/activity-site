---
layout: null
permalink: /search.json
---
[
  {% assign docs = site.posts | concat: site.pages %}
  {% assign first = true %}
  {% for d in docs %}
    {% comment %}
    検索対象の除外条件：
    1) draft/下書きやリダイレクト用などを除外したい場合は front matter に search_exclude: true を付ける
    2) レイアウトやアセット類は自動的に除外（content が空のものは弾く）
    {% endcomment %}
    {% if d.search_exclude != true and d.title and d.url and d.content %}
      {% unless first %},{% endunless %}
      {
        "title": {{ d.title | jsonify }},
        "url": {{ (site.baseurl | append: d.url) | replace: '//', '/' | jsonify }},
        "date": {{ d.date | date: "%Y-%m-%d" | jsonify }},
        "tags": {{ d.tags | default: empty | jsonify }},
        "categories": {{ d.categories | default: empty | jsonify }},
        "excerpt": {{ d.excerpt | default: d.content | strip_html | strip_newlines | truncate: 180 | jsonify }},
        "content": {{ d.content | strip_html | strip_newlines | jsonify }}
      }
      {% assign first = false %}
    {% endif %}
  {% endfor %}
]
