<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{{ page.title }} | {{ site.title }}</title>
  <meta name="description" content="{{ site.description }}">
  {% seo %}

  <style>
    :root{
      --base-font: system-ui, -apple-system, "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      --accent:#2563eb;
      --bg:#f9fafb;
      --text:#111827;
      --radius:12px;
      --shadow:0 2px 8px rgba(0,0,0,.04);
    }

    /* ===== base ===== */
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      line-height:1.6;
      font-family:var(--base-font);
      -webkit-text-size-adjust:100%;
      text-size-adjust:100%;
    }

    /* ===== header / global nav ===== */
    header{
      position:sticky; top:0; z-index:10;
      background:#fff; border-bottom:1px solid #e5e7eb;
      padding:.8rem 1rem .6rem;
    }
    header h1{
      margin:0; font-size:1.15rem; text-align:center; font-weight:700;
    }
    header h1 a{ color:inherit; text-decoration:none }

    nav.global{
      display:flex; justify-content:center; flex-wrap:wrap;
      gap:.45rem; margin-top:.45rem;
    }
    nav.global a{
      padding:.35rem .65rem; border:1px solid #e5e7eb; border-radius:10px;
      background:#f3f4f6; color:#374151; text-decoration:none; font-size:.9rem;
      transition:background .15s ease;
    }
    nav.global a:hover,
    nav.global a.active{
      background:#eaf2ff; color:var(--accent); border-color:#cfe0ff;
    }

    /* ===== main & footer ===== */
    main{
      max-width:960px; margin:0 auto; padding:1.1rem;
      background:#fff; border-radius:var(--radius); box-shadow:var(--shadow);
    }
    footer{ text-align:center; color:#6b7280; font-size:.85rem; margin:1.3rem 0 2rem }

    /* ===== mobile first ===== */
    @media (max-width: 720px){
      header{ padding:.7rem .8rem .55rem }
      header h1{ font-size:1rem }
      nav.global a{ font-size:.84rem; padding:.28rem .55rem; border-radius:9px }
      main{ padding:.9rem; border-radius:0; box-shadow:none }
    }
  </style>
</head>
<body>

<header>
  <h1><a href="{{ '/' | relative_url }}">{{ site.title }}</a></h1>
  <nav class="global">
    <a href="{{ '/' | relative_url }}"
       class="{% if page.url == '/' or page.url == '/index.html' %}active{% endif %}">🏠 トップ</a>

    <a href="{{ '/pages/promise.html' | relative_url }}"
       class="{% if page.url contains '/pages/promise' %}active{% endif %}">📌 公約</a>

    <a href="{{ '/pages/activity.html' | relative_url }}"
       class="{% if page.url contains '/pages/activity' %}active{% endif %}">🏡 活動</a>

    <a href="{{ '/pages/matrix.html' | relative_url }}"
       class="{% if page.url contains '/pages/matrix' %}active{% endif %}">💬 一般質問</a>

    <a href="{{ '/pages/profile.html' | relative_url }}"
       class="{% if page.url contains '/pages/profile' %}active{% endif %}">👤 プロフィール</a>
  </nav>
</header>

<main>
  {{ content }}
</main>
<!-- ==== 共通PDFモーダル（全ページ共通） ==== -->
<dialog id="pdfModal" aria-label="PDF表示モーダル">
  <div class="modal-head">
    <strong id="pdfTitle">資料</strong>
    <button id="closeModal" aria-label="閉じる">×</button>
  </div>
  <div class="modal-body">
    <iframe id="pdfFrame" src="about:blank" title="PDFビューア" frameborder="0"></iframe>
  </div>
</dialog>

<style>
  :root{
    --safe-top: env(safe-area-inset-top, 0px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
  }
  dialog#pdfModal{
    width:min(960px,96vw);
    height:min(85vh,800px);
    border:none; padding:0; border-radius:12px;
    box-shadow:0 20px 40px rgba(0,0,0,.35);
  }
  dialog::backdrop{ background:rgba(0,0,0,.35); }
  .modal-head{
    display:flex; justify-content:space-between; align-items:center;
    padding:calc(.6rem + var(--safe-top)) .9rem .6rem;
    background:#fafafa; border-bottom:1px solid #e5e7eb;
  }
  .modal-body{ height:calc(100% - 48px - var(--safe-top)); overflow:hidden; }
  #pdfFrame{ width:100%; height:100%; display:block; }
  body.modal-open{ overflow:hidden; }
</style>

<script>
  const dlg = document.getElementById('pdfModal');
  const frame = document.getElementById('pdfFrame');
  const titleEl = document.getElementById('pdfTitle');

  // 共通クリックイベント
  document.addEventListener('click', (e)=>{
    const card = e.target.closest('[data-pdf]');
    if (!card) return;

    const url = card.dataset.pdf + (card.dataset.pdf.includes('?') ? '&' : '?') + 't=' + Date.now();
    frame.src = url;
    titleEl.textContent = card.dataset.title || '資料';

    dlg.showModal();
    document.body.classList.add('modal-open');
  });

  document.getElementById('closeModal').addEventListener('click', ()=>{
    dlg.close(); frame.src='about:blank';
    document.body.classList.remove('modal-open');
  });
</script>

<footer>
  <p>© {{ site.time | date: '%Y' }} {{ site.title }}</p>
</footer>

</body>
</html>
