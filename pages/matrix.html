---
layout: default
title: 一般質問（カテゴリ別・テーブル）
permalink: /pages/matrix.html
---

<h2 style="margin:0 0 10px;">一般質問（カテゴリ別・テーブル）</h2>
<p class="muted" style="margin:6px 0 16px;">行タップで詳細。環境によりモーダル or 下部パネルが開きます。上部ボタンで分野フィルタ、ヘッダー矢印で昇降切替。</p>

<style>
/* ============= 基本構造 ============= */
body, h1, h2, h3, p, td, th, button, a {
  font-family: "Noto Sans JP","Hiragino Sans","Yu Gothic UI","游ゴシック体","Meiryo",system-ui,sans-serif;
}
.muted{color:#64748b}
.matrix-wrap{overflow:auto;border:1px solid #eee;border-radius:12px;background:#fff}
table.matrix{width:100%;border-collapse:collapse;font-size:.95rem;table-layout:fixed}
.matrix th,.matrix td{padding:.5rem .6rem;border-bottom:1px solid #f1f5f9;vertical-align:middle}
.matrix thead th{position:sticky;top:0;background:#fafafa;z-index:1;white-space:nowrap;user-select:none}
.matrix tbody tr:hover{background:#fcfcff}

/* 列幅：要旨広め・分野細め */
.col-month{width:5.0rem}
.col-cat{width:3.0rem}
.col-act{width:6.0rem}
@media(max-width:840px){.col-month{width:4.8rem}.col-cat{width:2.8rem}.col-act{width:5.8rem}}
@media(max-width:480px){.col-month{width:4.6rem}.col-cat{width:2.6rem}.col-act{width:5.4rem}}

/* 要旨・会期 */
.cell-title{
  font-weight:700;line-height:1.35;overflow:hidden;text-overflow:ellipsis;
  display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical
}
.cell-session{font-size:.86rem;color:#64748b;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

/* ============= ソートボタン ============= */
.sort-btn{
  display:inline-flex;align-items:center;gap:.4rem;
  border:none;background:transparent;cursor:pointer;font:inherit;padding:.25rem .3rem;margin:-.25rem 0;
}
.sort-btn:focus{outline:3px solid #93c5fd;outline-offset:2px;border-radius:6px}
.sort-icon{width:14px;height:14px;display:inline-block}
.chev{transition:transform .15s ease, opacity .15s ease;opacity:.65}
[aria-sort="ascending"] .chev{transform:rotate(180deg)}
[aria-sort="descending"] .chev{transform:rotate(0deg)}
.sort-btn:hover .chev{opacity:1}

/* ============= 上部カテゴリフィルタ ============= */
.filter-bar{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:10px 0 12px;}
.filter-btn{
  display:inline-flex;align-items:center;gap:.45em;
  padding:.42rem .78rem;border:1px solid #d6d6dc;border-radius:999px;background:#fff;cursor:pointer;
  font-size:.86rem;line-height:1;text-decoration:none;font-weight:700;
}
.filter-btn[aria-pressed="true"]{background:#eef2ff;border-color:#c7d2fe}
.count{color:#64748b;font-variant-numeric:tabular-nums;font-weight:600}
.ficon{font-size:1rem;line-height:1}
.fb-edu .ficon{color:#3b82f6}.fb-wel .ficon{color:#ef476f}.fb-tour .ficon{color:#22c55e}.fb-oth .ficon{color:#94a3b8}

/* ============= 分野ピル（縦アイコン＋1文字） ============= */
.cat-pill{
  display:inline-flex;flex-direction:column;align-items:center;justify-content:center;gap:.12rem;
  padding:.28rem .3rem;border-radius:9px;font-weight:800;color:#fff;min-width:2.6rem;
}
.cat-pill .icon{font-size:.95rem;line-height:1}
.cat-pill .label{font-size:.72rem;line-height:1}
.cat-edu{background:#3b82f6} /* 教育 */
.cat-wel{background:#ef476f} /* 福祉 */
.cat-tour{background:#22c55e}/* 観光 */
.cat-oth{background:#94a3b8} /* その他 */

/* ============= PDF／詳細ボタン（最終版） ============= */
.matrix td:last-child .actions{
  display:flex !important;
  flex-direction:column;          /* 縦並び */
  align-items:flex-end;
  justify-content:center;
  gap:6px;
  padding-right:6px;
}
.matrix td:last-child .actions .btn{
  display:inline-flex;
  align-items:center;
  gap:4px;
  font-size:11px;
  font-weight:600;
  border-radius:8px;
  padding:3px 8px;
  line-height:1.2;
  background:#fff;
  text-decoration:none;
  border:1.5px solid transparent;
  box-shadow:0 1px 2px rgba(0,0,0,0.06);
  transition:all .15s ease;
  white-space:nowrap;
}

/* 🟣 PDF：紫＋色文字＋囲み */
.matrix td:last-child .actions .btn.pdf-link{
  border-color:#c7b8ff;
  background:#f5f3ff;
  color:#4f46e5;
}
.matrix td:last-child .actions .btn.pdf-link:hover{
  background:#ede9fe;
  border-color:#a78bfa;
}

/* ⚪ 詳細：灰青＋囲み */
.matrix td:last-child .actions .btn.ghost{
  border-color:#cbd5e1;
  background:#f8fafc;
  color:#475569;
}
.matrix td:last-child .actions .btn.ghost:hover{
  background:#f1f5f9;
  border-color:#94a3b8;
}

/* アイコン */
.matrix td:last-child .actions .btn.pdf-link::before{content:"📄";font-size:12px;}
.matrix td:last-child .actions .btn.ghost::before{content:"🔍";font-size:12px;}

/* モバイル対応 */
@media (max-width:480px){
  .matrix td:last-child .actions .btn{
    font-size:10px;
    padding:2px 6px;
    gap:3px;
  }
}
</style>

<!-- ▼ 分野フィルタ -->
<div class="filter-bar" id="filterBar" aria-label="分野フィルタ">
  <button class="filter-btn fb-all" data-cat="ALL" aria-pressed="true"><span class="ficon">🗂️</span><span>すべて</span> <span class="count" id="cnt-all">(0)</span></button>
  <button class="filter-btn fb-edu" data-cat="教育"><span class="ficon">🎓</span><span>教育</span> <span class="count" id="cnt-教育">(0)</span></button>
  <button class="filter-btn fb-wel" data-cat="福祉"><span class="ficon">❤️</span><span>福祉</span> <span class="count" id="cnt-福祉">(0)</span></button>
  <button class="filter-btn fb-tour" data-cat="観光"><span class="ficon">🏞️</span><span>観光</span> <span class="count" id="cnt-観光">(0)</span></button>
  <button class="filter-btn fb-oth" data-cat="その他"><span class="ficon">📄</span><span>その他</span> <span class="count" id="cnt-その他">(0)</span></button>
</div>

<!-- ▼ テーブル -->
<div class="matrix-wrap">
  <table class="matrix" id="matrixTable">
    <colgroup>
      <col class="col-month">
      <col>
      <col class="col-cat">
      <col class="col-act">
    </colgroup>
    <thead>
      <tr>
        <th id="thMonth">
          <button id="sortMonth" class="sort-btn" data-order="asc" aria-sort="ascending">
            <span>年月</span>
            <span class="sort-icon"><svg class="chev" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          </button>
        </th>
        <th>要旨・会期</th>
        <th id="thCat">
          <button id="sortCat" class="sort-btn" data-order="asc" aria-sort="none">
            <span>分野</span>
            <span class="sort-icon"><svg class="chev" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></span>
          </button>
        </th>
        <th>詳細</th>
      </tr>
    </thead>
    <tbody>
      {% assign rows = site.data.matrix.rows | default: empty %}
      {% for r in rows %}
        {% assign s = r.sakio %}
        {% assign cat = r.category | default: 'その他' %}
        {% assign c = cat | replace:'　','' | replace:' ','' | downcase %}
        {% capture catkey %}{% if c contains '教' %}edu{% elsif c contains '福' %}wel{% elsif c contains '観' %}tour{% else %}oth{% endif %}{% endcapture %}
        {% capture catlabel %}{% if catkey == 'edu' %}教育{% elsif catkey == 'wel' %}福祉{% elsif catkey == 'tour' %}観光{% else %}その他{% endif %}{% endcapture %}
        {% capture caticon %}{% if catkey == 'edu' %}🎓{% elsif catkey == 'wel' %}❤️{% elsif catkey == 'tour' %}🏞️{% else %}📄{% endif %}{% endcapture %}
        {% capture catabbr %}{% if catkey == 'edu' %}教{% elsif catkey == 'wel' %}福{% elsif catkey == 'tour' %}観{% else %}他{% endif %}{% endcapture %}
        <tr class="row"
            data-cat="{{ catlabel }}"
            data-catkey="{{ catkey }}"
            data-month="{{ s.month | replace:'-','' | plus:0 }}"
            data-month-iso="{{ s.month }}"
            data-title="{{ s.text | escape }}"
            data-session="{{ s.session | escape }}"
            data-pdf="{{ s.pdf | relative_url }}"
            data-related='{{ r.related | jsonify }}'>
          <td>{{ s.month }}</td>
          <td><div class="cell-title">{{ s.text }}</div><div class="cell-session">{{ s.session }}</div></td>
          <td>
            <span class="cat-pill cat-{{ catkey }}" title="{{ catlabel }}" aria-label="{{ catlabel }}">
              <span class="icon">{{ caticon }}</span>
              <span class="label">{{ catabbr }}</span>
            </span>
          </td>
          <td>
            <div class="actions">
              {% if s.pdf %}<a class="btn pdf-link" href="{{ s.pdf | relative_url }}" data-modal="pdf" data-title="{{ s.text }}">PDF</a>{% endif %}
              <a class="btn ghost detail-link" href="#">詳細</a>
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- ▼ モーダル＆フォールバック -->
<dialog id="detailModal" aria-label="質問の詳細">
  <div style="display:flex;justify-content:space-between;align-items:center;padding:.7rem .9rem;border-bottom:1px solid #eee">
    <strong id="detailTitle"></strong>
    <button id="closeDetail" class="btn">×</button>
  </div>
  <div style="padding:.8rem .9rem .9rem;font-size:.95rem;line-height:1.6">
    <p class="meta"><strong>会期:</strong> <span id="detailSession"></span></p>
    <p class="meta"><strong>年月:</strong> <span id="detailMonth"></span>　<strong>分野:</strong> <span id="detailCat"></span></p>
    <div id="detailRelated"></div>
    <div id="detailPDF" style="margin-top:.6rem;"></div>
  </div>
</dialog>

<section id="detailPanel" aria-live="polite">
  <h3 id="dpTitle"></h3>
  <p class="meta"><strong>会期:</strong> <span id="dpSession"></span></p>
  <p class="meta"><strong>年月:</strong> <span id="dpMonth"></span>　<strong>分野:</strong> <span id="dpCat"></span></p>
  <div id="dpRelated"></div>
  <div id="dpPDF" style="margin-top:.6rem;"></div>
</section>
