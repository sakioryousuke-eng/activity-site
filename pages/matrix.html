---
layout: default
title: 一般質問（カテゴリ別・テーブル）
permalink: /pages/matrix.html
---

<h2 style="margin:0 0 10px;">一般質問（カテゴリ別・テーブル）</h2>
<p class="muted" style="margin:6px 0 16px;">行の空白タップで詳細モーダル、右端の「詳細」から専用ページへ。</p>

<style>
body, h1, h2, h3, p, td, th, button, a {
  font-family: "Noto Sans JP","Hiragino Sans","Yu Gothic UI","游ゴシック体","Meiryo",system-ui,sans-serif;
}
.matrix-wrap{overflow:auto;border:1px solid #eee;border-radius:12px;background:#fff}
table.matrix{width:100%;border-collapse:collapse;font-size:.95rem;table-layout:fixed}
.matrix th,.matrix td{padding:.5rem .6rem;border-bottom:1px solid #f1f5f9;vertical-align:top}
.matrix thead th{position:sticky;top:0;background:#fafafa;z-index:1;font-weight:700;white-space:nowrap;cursor:pointer;user-select:none}
.matrix tr:hover{background:#fcfcff}
.muted{color:#64748b}

.col-month{width:5.6rem}
.col-cat{width:6.8rem}
.col-act{width:7.0rem}
.cat-badge{display:inline-flex;align-items:center;gap:.42rem}
.dot{width:.58rem;height:.58rem;border-radius:50%}
.dot.edu{background:#3b82f6}.dot.wel{background:#ef476f}.dot.tour{background:#22c55e}.dot.oth{background:#94a3b8}
.btn{display:inline-flex;align-items:center;gap:.3em;padding:.24rem .52rem;border:1px solid #d6d6dc;border-radius:999px;background:#fff;text-decoration:none;font-size:.82rem;line-height:1;white-space:nowrap}
.btn:hover{background:#f5f7ff}
.btn + .btn{margin-left:.3rem}
.cell-title{font-weight:700;line-height:1.35;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
.cell-session{font-size:.86rem;color:#64748b;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
@media(max-width:840px){.col-month{width:5.2rem}.col-cat{width:6.2rem}.col-act{width:6.6rem}}
@media(max-width:480px){.col-month{width:4.9rem}.col-cat{width:5.8rem}.col-act{width:6.2rem}.cell-session{display:none}}
</style>

<div class="matrix-wrap">
  <table class="matrix" id="matrixTable">
    <colgroup>
      <col class="col-month"><col><col class="col-cat"><col class="col-act">
    </colgroup>
    <thead>
      <tr>
        <th id="sortMonth" data-order="asc">年月 ▲</th>
        <th>要旨・会期</th>
        <th id="sortCat" data-order="asc">分野 ▲</th>
        <th>詳細</th>
      </tr>
    </thead>
    <tbody>
      {% for cat in site.data.matrix %}
        {% assign catname = cat[0] %}
        {% assign catlist = cat[1] %}
        {% for entry in catlist %}
          {% assign s = entry.sakio %}
          {% assign key = catname | append: '-' | append: s.month | append: '-' | append: s.text | slugify %}
          {% assign c = catname | replace:'　','' | replace:' ','' | downcase %}
          {% capture catkey %}{% if c contains '教' %}edu{% elsif c contains '福' %}wel{% elsif c contains '観' %}tour{% else %}oth{% endif %}{% endcapture %}
          <tr class="row" data-key="{{ key }}" data-cat="{{ catname }}" data-catkey="{{ catkey }}" data-month="{{ s.month | replace:'-','' | plus:0 }}" data-title="{{ s.text }}" data-session="{{ s.session }}" data-pdf="{{ s.pdf | relative_url }}" data-related='{{ entry.related | jsonify }}'>
            <td>{{ s.month }}</td>
            <td>
              <div class="cell-title">{{ s.text }}</div>
              <div class="cell-session">{{ s.session }}</div>
            </td>
            <td><span class="cat-badge"><span class="dot {{ catkey }}"></span>
              {% if catkey == 'edu' %}教育{% elsif catkey == 'wel' %}福祉{% elsif catkey == 'tour' %}観光{% else %}その他{% endif %}
            </span></td>
            <td>
              {% if s.pdf %}<a class="btn" data-modal="pdf" href="{{ s.pdf | relative_url }}">PDF</a>{% endif %}
              <a class="btn ghost" href="{{ '/pages/matrix-detail.html' | relative_url }}?k={{ key }}">詳細</a>
            </td>
          </tr>
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>
</div>

{% raw %}
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const table=document.querySelector('#matrixTable');
  const tbody=table.querySelector('tbody');
  const rows=Array.from(tbody.querySelectorAll('tr.row'));

  // === ソート処理 ===
  const catOrder=['教育','福祉','観光','その他'];
  const thMonth=document.getElementById('sortMonth');
  const thCat=document.getElementById('sortCat');

  function applySort(){
    const mOrder=thMonth.dataset.order;
    const cOrder=thCat.dataset.order;
    let sorted=[...rows];
    sorted.sort((a,b)=>{
      const ma=+a.dataset.month, mb=+b.dataset.month;
      const ca=a.dataset.cat, cb=b.dataset.cat;
      if (sortKey==='month'){
        return mOrder==='asc'?ma-mb:mb-ma;
      }else if (sortKey==='cat'){
        const ai=catOrder.indexOf(ca)>=0?catOrder.indexOf(ca):99;
        const bi=catOrder.indexOf(cb)>=0?catOrder.indexOf(cb):99;
        if(ai!==bi)return cOrder==='asc'?ai-bi:bi-ai;
        return mOrder==='asc'?ma-mb:mb-ma;
      }
    });
    sorted.forEach(r=>tbody.appendChild(r));
  }

  let sortKey='month';
  thMonth.addEventListener('click',()=>{
    thMonth.dataset.order=thMonth.dataset.order==='asc'?'desc':'asc';
    thMonth.textContent=thMonth.dataset.order==='asc'?'年月 ▲':'年月 ▼';
    sortKey='month';applySort();
  });
  thCat.addEventListener('click',()=>{
    thCat.dataset.order=thCat.dataset.order==='asc'?'desc':'asc';
    thCat.textContent=thCat.dataset.order==='asc'?'分野 ▲':'分野 ▼';
    sortKey='cat';applySort();
  });
  applySort();
});
</script>
{% endraw %}
